chrome.runtime.onInstalled.addListener(s=>{s.reason==="install"&&(console.log("Listing Comments extension installed"),chrome.storage.sync.set({enabled:!0,showAnonymousWarning:!0,autoExpand:!1}))});chrome.runtime.onMessage.addListener((s,t,e)=>{switch(s.type){case"GET_SETTINGS":return chrome.storage.sync.get(["enabled","showAnonymousWarning","autoExpand"],n=>{e(n)}),!0;case"SAVE_SETTINGS":return chrome.storage.sync.set(s.settings,()=>{e({success:!0})}),!0;case"GET_AUTH_STATUS":e({isAuthenticated:!1,user:null});break;case"SIGN_IN":console.log("Sign in requested"),e({success:!1,message:"Authentication not implemented yet"});break;case"SIGN_OUT":console.log("Sign out requested"),e({success:!0});break;default:console.log("Unknown message type:",s.type),e({error:"Unknown message type"})}});chrome.tabs.onUpdated.addListener((s,t,e)=>{t.status==="complete"&&e.url&&["zillow.com","redfin.com","apartments.com","loopnet.com"].some(o=>e.url.includes(o))&&console.log("Listing page detected:",e.url)});chrome.storage.onChanged.addListener((s,t)=>{t==="sync"&&(console.log("Settings changed:",s),chrome.tabs.query({},e=>{e.forEach(n=>{n.url&&(n.url.includes("zillow.com")||n.url.includes("redfin.com")||n.url.includes("apartments.com")||n.url.includes("loopnet.com"))&&chrome.tabs.sendMessage(n.id,{type:"SETTINGS_CHANGED",changes:s}).catch(()=>{})})}))});chrome.runtime.onStartup.addListener(()=>{console.log("Listing Comments extension started")});chrome.runtime.onSuspend.addListener(()=>{console.log("Listing Comments extension suspended")});
